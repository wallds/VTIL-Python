name: CI

on: [push, pull_request]

jobs:
  build:
    # Skip building pull requests from the same repository
    if: ${{ github.event_name == 'push' || (github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name != github.repository) }}
    strategy:
      fail-fast: false
      matrix:
        runs-on: [windows-latest]
        arch: [x64]
        python:
        - '3.10'
        - '3.11'
    
    name: "üêç ${{ matrix.python }} ‚Ä¢ ${{ matrix.runs-on }} ‚Ä¢ ${{ matrix.arch }}"
    runs-on: ${{ matrix.runs-on }}

    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Setup Python ${{ matrix.python }}
      uses: actions/setup-python@v4
      with:
        python-version: ${{ matrix.python }}

    - name: Prepare env
      run: |
        python -m pip install wheel

    - name: Add msbuild to PATH
      uses: microsoft/setup-msbuild@v1.1.3
      with:
        msbuild-architecture: ${{ matrix.arch }}

    - name: Build
      run: |
        python setup.py bdist_wheel

    - name: 'Upload Artifact'
      uses: actions/upload-artifact@v3
      with:
        name: my-artifact
        path: ./dist/*.whl
        retention-days: 5
